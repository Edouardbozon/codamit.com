---
title: State of Rspack in Angular
draft: true
description: TODO
---

Recently real progress has been made around Rspack and Angular. This post will cover the current state of Rspack in Angular and what the future holds.

<Tweet tweetLink="victorsavkin/status/1880770676128362584"/>

Let's start with a brief history of compiling and bundling in Angular.

## Angular CLI

Angular CLI handles the build process and provides an easy interface for compiling and bundling Angular applications. While powerful, the CLI has its limitations, particularly for customizing the underlying tools, or extending the build process.

> The CLI abstracts the underlying tools through builders, treating them as implementation details.

<Tweet tweetLink="mgechev/status/1869510279782170847"/>

### Esbuild limitations

Esbuild is the default bundler used internally by the CLI since Angular v17, it is **drastically faster than Webpack but it is not as feature-rich**.

#### Code-splitting

One limitation with Esbuild is its **lack of support for customizing the chunking strategy**, see the related issues:

- [**Max size/request control over chunk splitting** #1128](https://github.com/evanw/esbuild/issues/1128)
- [**Code splitting is creating many small unnecessary chunks** #3780](https://github.com/evanw/esbuild/issues/3780)
- [**Degraded Web Vitals after switching a universal app to esbuild** #27321](https://github.com/angular/angular-cli/issues/27321)
- [**Creating unnecessary excessive chunks** #27715](https://github.com/angular/angular-cli/issues/27715)

This can lead to excessive chunks loading and degraded Web Vitals, it is a major issue for performance-sensitive applications.

#### Module Federation

When building a micro-frontend architecture, we might want to use the [Module Federation 2.0](https://module-federation.io/guide/start/index.html), which is not supported by Esbuild and Angular, so we're stuck with Webpack and everything it implies.

<Note>
Shout out to [Native Federation](https://www.npmjs.com/package/@angular-architects/native-federation) which provides a bundler agnostic solution compatible with Esbuild, it is inspired by Module Federation's mental model, but keep in mind that it is a different tool maintained by another team.
</Note>

#### TypeScript Project References

Another limitation is the lack of support for TypeScript Project References, which is a feature that allows splitting a large TypeScript project into smaller projects. This is useful for large applications, but it is not supported by Esbuild.

See my article on this topic: [Nx 20: Exploring the new TS preset and TypeScript project references](/nx-20-exploring-the-new-ts-preset-and-typescript-project-references/).

## Rspack to the rescue

It is where [Rspack](https://rspack.dev/) and [Angular Rspack](https://angular-rspack.dev/) come into play.

> Rspack is a high performance JavaScript bundler written in Rust. It offers strong compatibility with the Webpack ecosystem, allowing for seamless replacement of Webpack, and provides lightning fast build speeds.

Rspack offers control over the chunking strategy and supports Module Federation out-of-the-box while being faster than Webpack. Sounds promising, right?

| Bundler       | Prod SSR     | Prod     | Dev     |
|---------------|--------------|----------|---------|
| üêå Webpack    | 348.707      | 224.226  | 234.449 |
| ü•â Esbuild    | 28.509       | 24.521   | 18.719  |
| ü•à Rsbuild    | 24.690       | 20.490   | 19.675  |
| üèÜ Rspack     | 19.974       | 18.239   | 16.477  |

Note that these results should be taken carefully and might not represent every use cases, see the [benchmarks](https://github.com/Coly010/ng-bundler-benchmark) for more details.

### Usage in Angular

<Note type="warning">
Rspack is not officially supported by Angular, while it is possible to use it, [Angular Rspack](https://angular-rspack.dev/) is still a POC that is not recommended for production applications.
</Note>

```bash
npm install @rspack/cli @ng-rspack/build -D
```

Configure Rspack with a `rspack.config.js` file:

```js
const { createConfig } = require('@ng-rspack/build');

module.exports = createConfig({
  root: __dirname,
  name: 'demo',
  index: './src/index.html',
  assets: ['./public'],
  styles: ['./src/styles.css'],
  polyfills: ['zone.js'],
  main: './src/main.ts',
  outputPath: './dist/browser',
  tsConfig: './tsconfig.app.json',
});
```

Build and serve the application:

```bash
npx rspack build # or npx rspack dev
```

### Rsbuild

Rsbuild is a superset of Rspack, providing pre-configured setups.

```bash
npm i @rsbuild/core @ng-rspack/plugin-angular -D
```

#### CSR

```ts
import { createConfig } from '@ng-rsbuild/plugin-angular';

export default createConfig({
  browser: './src/main.ts',
});
```

#### SSR

```ts
import { createConfig } from '@ng-rsbuild/plugin-angular';

export default createConfig({
  browser: './src/main.ts',
  server: './src/main.server.ts',
  ssrEntry: './src/server.ts',
});
```

### Rsbuild with Nx (recommended)



### Strenghts

TypeScript Project References Support
SSR Support (with Incremental Hydration)
